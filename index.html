<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <!--путь к ресурсам сайта-->
    <meta name="resources-path" content="resources/">

    <title>Beats</title>
    <meta name="viewport" content="initial-scale=1, minimal-ui"/>
    <link rel="stylesheet" href="resources/css/styles.css">
    <script src="resources/js/libs/modernizr.js"></script>
    <script src="resources/js/libs/webcomponents-lite.js"></script>
    <script src="resources/js/libs/setPrototypeOf.polyfill.js"></script>
    <script data-main="resources/js/app" src="resources/js/require.js"></script>
</head>
<body>

    <vh-fix></vh-fix>
    <page-transition></page-transition>
    <router-component></router-component>

    <preloader-component>
        <loading-screen data-id="preloader-screen"></loading-screen> 
        <div class="wrapper">
            <div class="text">
                <h1 class="loaded-text" data-text="Qualia Qua Beats">Qualia Qua Beats</h1>
                <div class="perc">0%</div>
                <div class="nt">Soundtrack to life</div>
            </div>
        </div>
    </preloader-component>

    <audio-player data-ambient="tmp/audio/Gulag_BPM130_Tag.mp3">
        <audio src=""></audio>
        <audio src=""></audio>
    </audio-player>

    <div is="scheme-component" class="page-wrapper" data-scheme="bright" data-popup="inactive">
        <header>
            <div class="logo">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 91.72 99.61">
                    <g id="Layer_1" data-name="Layer 1">
                        <polygon class="cls-1" points="64.38 77.36 80.48 99.61 48.29 83.04 57.45 78.57 64.38 77.36"/>
                        <polygon class="cls-1" points="57.55 79.5 80.48 99.61 48.29 83.04 57.45 78.57 57.55 79.5"/>
                        <polygon class="cls-1" points="91.72 90.62 91.42 90.33 72.31 70.84 72.31 70.83 74.11 64.86 79.83 56.42 80.52 58.41 91.42 89.77 91.57 90.19 91.72 90.62"/>
                        <polygon class="cls-1" points="75.26 66.04 91.72 90.62 79.83 56.42 74.12 64.87 75.26 66.04"/>
                        <path class="cls-1" d="M41.94,0A42,42,0,1,0,64.39,77.36l0.07,0L59.26,70.4a33.52,33.52,0,1,1,6.93-5.65l6.12,6.08h0a41.83,41.83,0,0,0,3.41-4.07,42.46,42.46,0,0,0,4.78-8.34A41.95,41.95,0,0,0,41.94,0Z"/>
                        <path class="cls-1" d="M51.24,49.94a12.21,12.21,0,1,0-4.77,3.41l7.64,10.18a24.72,24.72,0,1,1,6-4.76Z"/>
                        <polygon class="cls-1" points="91.72 90.06 91.57 90.19 91.48 90.27 91.42 90.33 72.31 70.84 72.31 70.83 72.32 70.83 90.61 88.97 90.62 88.98 91.42 89.77 91.72 90.06"/>
                        <path class="cls-1" d="M72.74,70.39"/>
                    </g>
                </svg>
            </div>
            <button is="popup-toggle" class="menu-btn" data-id="menu-popup">
                <div class="b b1"></div>
                <div class="b b2"></div>
                <div class="b b3"></div>
                <div class="b b4"></div>
                <div class="b b5"></div>
                <div class="b b6"></div>
            </button>
            <div class="title">Beats:</div>
        </header>

        <div class="cart">
            <span>Cart</span>
            <button class="btn">[+0]</button>
        </div>

        <audio-progressbar>
            <div class="ac"></div>
        </audio-progressbar>

        <popup-component class="menu-popup" data-id="menu-popup">
            <div class="stage-fallback"></div>
            <div class="popup-outer">
                <div class="popup-inner">
                    <div class="popup-cell">
                        <nav class="menu">
                            <div class="item">
                                <a href="index.html"
                                    is="menu-link"
                                    class="active">
                                    <menu-text data-to="Beats">B%43s</menu-text>
                                </a>
                            </div>
                            <div class="item">
                                <a href="albums.html"
                                    is="menu-link">
                                    <menu-text data-to="Album">Alc5?</menu-text>
                                </a>
                            </div>
                            <div class="item">
                                <a href="videos.html"
                                    is="menu-link">
                                    <menu-text data-to="Video">Vi#d0</menu-text>
                                </a>
                            </div>
                            <div class="item">
                                <a href="about.html"
                                    is="menu-link">
                                    <menu-text data-to="About">A$ou4</menu-text>
                                </a>
                            </div>
                            <div class="item">
                                <a href="merch.html"
                                    is="menu-link">
                                    <menu-text data-to="Merch">M8.c3</menu-text>
                                </a>
                            </div>
                        </nav>
                    </div>
                </div>
            </div>
        </popup-component>
        
        <div class="replaceable" data-id="popups">
            <popup-component class="all-tracks-popup" data-id="all-tracks-popup">
                <div class="stage-fallback"></div>
                <div class="popup-outer">
                    <div class="popup-inner">
                        <div class="section-header">
                            <div class="left-wrapper">
                                <button is="popup-close" class="btn close">[Close]</button>
                            </div>
                        </div>
                        <section class="all-tracks">
                            <track-list class="tracks-list" data-id="beats">
                                <div class="tracks-group">
                                    <h3># Hip-hop</h3>
                                    <ol>
                                        <li class="track"  data-src="tmp/audio/Mt. Zion.mp3">
                                            <span>Mt. Zion</span>
                                        </li>
                                        <li class="track" data-src="tmp/audio/Spaced Out.mp3">
                                            <span>Spaced Out</span>
                                        </li>
                                        <li class="track" data-src="tmp/audio/Gulag_BPM130_Tag.mp3">
                                            <span>Gulag_BPM130_Tag</span>
                                        </li>
                                        <li class="track" data-src="tmp/audio/Spaced Out.mp3">
                                            <span>Spaced Out</span>
                                        </li>
                                    </ol>
                                </div>
                                <div class="tracks-group">
                                    <h3># Epic</h3>
                                    <ol>
                                        <li class="track" data-src="tmp/audio/Spaced Out.mp3">
                                            <span>Spaced Out</span>
                                        </li>
                                        <li class="track" data-src="tmp/audio/Gulag_BPM130_Tag.mp3">
                                            <span>Gulag_BPM130_Tag</span>
                                        </li>
                                        <li class="track" data-src="tmp/audio/Spaced Out.mp3">
                                            <span>Spaced Out</span>
                                        </li>
                                    </ol>
                                </div>
                                <div class="tracks-group">
                                    <h3># Tropical</h3>
                                    <ol>
                                        <li class="track"  data-src="tmp/audio/Mt. Zion.mp3">
                                            <span>Mt. Zion</span>
                                        </li>
                                        <li class="track" data-src="tmp/audio/Spaced Out.mp3">
                                            <span>Spaced Out</span>
                                        </li>
                                    </ol>
                                </div>
                                <div class="tracks-group">
                                    <h3># Cinematic</h3>
                                    <ol>
                                        <li class="track" data-src="tmp/audio/Spaced Out.mp3">
                                            <span>Spaced Out</span>
                                        </li>
                                        <li class="track" data-src="tmp/audio/Gulag_BPM130_Tag.mp3">
                                            <span>Gulag_BPM130_Tag</span>
                                        </li>
                                        <li class="track" data-src="tmp/audio/Spaced Out.mp3">
                                            <span>Spaced Out</span>
                                        </li>
                                    </ol>
                                </div>
                            </track-list>
                            <div class="clear"></div>
                        </section>
                    </div>
                </div>
            </popup-component>
        </div>

        <div class="stage-fallback"></div>
        <stage-component></stage-component>

        <main class="vh-min-height">
            <div class="content replaceable" data-id="main-content">
                <beats-helper></beats-helper>
                <div class="beat-bg stage-fallback"></div>

                <div class="section-header beat-header">
                    <div class="left-wrapper">
                        <button is="audio-pause" class="btn dark pause">[Pause]</button>
                        <audio-progress class="time">
                            <span class="mn">00.</span><span class="sc">00.</span><span class="ms">000</span>
                        </audio-progress>
                    </div>
                </div>


                <div class="section-footer beat-footer">
                    <div class="left-wrapper">
                        <button class="btn dark big buy">[Buy]</button>
                        <print-slider class="price" data-id="price-print" data-pool="number">
                            <div></div>
                        </print-slider>
                    </div>
                </div>

                <div class="beat-aside">
                    <div class="left-wrapper">
                        <div class="inner vh-height">
                            <button is="popup-toggle" class="btn dark all" data-id="all-tracks-popup">[+]</button>
                            <slide-scroll-index 
                                data-id="beat-slides"
                                class="beat-index">1</slide-scroll-index>
                            <button class="arr a-t"
                                is="slide-scroll-control"
                                data-id="beat-slides"
                                data-to="prev">
                                <div class="ico"></div>
                            </button>
                            <button class="arr a-b" 
                                is="slide-scroll-control"
                                data-id="beat-slides"
                                data-to="next">
                                <div class="ico"></div>
                            </button>
                            <slide-scroll-total 
                                data-id="beat-slides"
                                class="beat-total">12</slide-scroll-total>
                        </div>
                    </div>
                </div>

                <slide-scroll data-id="beat-slides" 
                    data-min-heights="0:460;640:640;1000:600;1400:700;1800:720">
                    <div class="slide-scroll-wrapper">
                        <section class="beat js-slide vh-min-height">
                            <div class="left-wrapper">
                                <div class="slide-content beat-content">
                                    <h1 is="header-component">Spaced Grey marbled</h1>
                                    <text-print class="nfo">
                                        <div>Date release: 2016 Dec</div>
                                        <div>Album: Souandtrack</div>
                                        <div>Genre: Hip-hop</div>
                                    </text-print>
                                    <!-- price -->
                                    <div class="data-hidden" data-id="price-print">
                                        <div>$ 20.00</div>
                                    </div>
                                </div>
                            </div>
                        </section>
                        <section class="beat js-slide vh-min-height">
                            <div class="left-wrapper">
                                <div class="slide-content beat-content">
                                    <h1 is="header-component">Souandtrack Souandtrack</h1>
                                    <text-print class="nfo">
                                        <div>Date release: 2016 Dec</div>
                                        <div>Album: Souandtrack</div>
                                        <div>Genre: Hip-hop</div>
                                    </text-print>

                                    <div class="data-hidden" data-id="price-print">
                                        <div>$ 32.00</div>
                                    </div>
                                </div>
                            </div>
                        </section>
                        <section class="beat js-slide vh-min-height">
                            <div class="left-wrapper">
                                <div class="slide-content beat-content">
                                    <h1 is="header-component">Release Grey Spaced</h1>

                                    <text-print class="nfo">
                                        <div>Date release: 2016 Dec</div>
                                        <div>Album: Souandtrack</div>
                                        <div>Genre: Hip-hop</div>
                                    </text-print>

                                    <div class="data-hidden" data-id="price-print">
                                        <div>$ 14.40</div>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                </slide-scroll>

                <aside class="cover">
                    <beat-bg-slider class="cover-bg">
                        <div class="slide">
                            <div class="bg" style="background-image: url(tmp/beat-covers/1.jpg);"></div>
                        </div>
                        <div class="slide">
                            <div class="bg" style="background-image: url(tmp/beat-covers/2.jpg);"></div>
                        </div>
                        <div class="slide">
                            <div class="bg" style="background-image: url(tmp/beat-covers/3.jpg);"></div>
                        </div>
                    </beat-bg-slider>
                    <div class="cover-img">
                        <proportional-height>
                            <img src="tmp/beat-lables/1.jpg" alt="">
                            <img src="tmp/beat-lables/2.jpg" alt="">
                            <img src="tmp/beat-lables/3.jpg" alt="">
                        </proportional-height>
                    </div>
                </aside>
            </div>
        </main>
    </div>

    <script type="x-shader/x-vertex" id="simpleVertexShader">
        varying vec2 vUv;
        void main() {
            vUv = uv;
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        }
    </script>

    <script type="x-shader/x-fragment" id="simpleFragmentShader">
        varying vec2 vUv;
        uniform sampler2D tDiffuse;

        void main() {
            float vx = vUv.x;
            float vy = vUv.y;
            gl_FragColor = texture2D(tDiffuse, vec2(vx, vy));
        }
    </script>

    <script type="x-shader/x-fragment" id="loadingFragmentShader">
        varying vec2 vUv;
        uniform sampler2D tDiffuse;
        uniform vec2 res;
        uniform float Fi;
        uniform float fact;
        uniform float globalA;
        uniform float disA;

        float rand(float n) {
            return fract(753.5453123*sin(n + 113.));
        }

        float noise(vec3 x) { 
            vec3 p = floor(x); 
            vec3 f = fract(x); 
            f = f*f*(3.-2.*f); 

            float n = p.x + p.y*157. + 113.*p.z * fact/100.0; 

            float v2 = rand(n); 
            return v2; 
        }
        float fSimpNoise(vec3 p) { 
            p.z = p.z + fact*16.0;
            return dot(vec3(noise(p), noise(p*2.),  noise(p*4.)), 
            vec3(0.5, 0.25, 0.2)); 
        }
        float fnoise(vec3 p) { 
            p.z = p.z + fact*6.0;
            return dot(vec4(noise(p), noise(p*2.3), noise(p*4.3), noise(p*8.4)), 
            vec4(0.5, 0.25, 0.2, 0.125)); 
        }

        float insideBox(vec2 v, vec2 bottomLeft, vec2 topRight) {
            vec2 s = step(bottomLeft, v) - step(topRight, v);
            return s.x * s.y;   
        }

        void main() {
            float vx = vUv.x;
            float vy = vUv.y;

            vec3 vUv2 = mat3(
                cos(Fi)*(1.0 - Fi), sin(Fi), 0.,
                -sin(Fi), cos(Fi)*(1.0 - Fi), 0.,
                0., 0., 1.0 - Fi)*
            vec3(vUv.x - 0.5, vUv.y - 0.5, 1.);

            vec3 p = vec3(vUv2.x*30., vUv2.y*30., 0.);
            vec3 pA = vec3(vUv.x*10., vUv.y*10., 0.);
            float result = fnoise(p); 
            result = clamp(result, 0.52, 1.);

            result = ((result - 0.52)/8.)*globalA + 0.062745;

            float colAlpha = fSimpNoise(pA);
            colAlpha /= 4.;

            float a = mix(1., 0., 1.0 - (colAlpha + disA));
            a = clamp(a, 0., 1.);
            gl_FragColor = vec4(result, result, result, a);
        }
    </script>

    <script type="x-shader/x-fragment" id="bufferFragmentShader">
        precision highp float;

        uniform vec2 res;
        uniform sampler2D bufferTexture;
        uniform float st;
        uniform float blurH;
        uniform vec4 gBox;
        uniform float shift;

        varying vec2 vUv;

        float insideBox(vec2 v, vec2 bottomLeft, vec2 topRight) {
            vec2 s = step(bottomLeft, v) - step(topRight, v);
            return s.x * s.y;   
        }

        void main() {
            float sr = 64.0 / 255.0;
            float sg = 219.0 / 255.0;
            float sb = 225.0 / 255.0;
            vec4 blue = vec4(sr, sg, sb, 1.0);

            vec2 pixel = gl_FragCoord.xy / res.xy;

            float t = insideBox(
                pixel, 
                vec2(min(gBox.x, gBox.z), min(gBox.y, gBox.w)),
                vec2(max(gBox.x, gBox.z), max(gBox.y, gBox.w))
            );

            pixel.x = pixel.x + t*shift;

            pixel.y = pixel.y - 0.004;
            vec4 color = texture2D(bufferTexture, pixel);


            // if (abs(sr - color.r) <= 0.03) {
            //     color = blue;
            // } else {
            //     // color.r = color.r - (color.r - sr) / 100.0;
            //     // color.g = color.g - (color.g - sg) / 100.0;
            //     // color.b = color.b - (color.b - sb) / 100.0;
            //     color = mix(color, blue, 0.03);
            // }

            if (st == 0.0) {
                color = blue;
            } else {
                if (mod(st, 3.0) == 0.0) {
                    color = mix(color, blue, 0.05); 
                }
            }

            // gl_FragColor = sum;

            gl_FragColor = color;
        }
    </script>

    <script type="x-shader/x-fragment" id="gradientFragmentShader">
        varying vec2 vUv;

        void main() {
            float sr = 201.0 / 255.0;
            float sg = 36.0 / 255.0;
            float sb = 217.0 / 255.0;

            float tr = 99.0 / 255.0;
            float tg = 172.0 / 255.0;
            float tb = 223.0 /255.0;

            float vx = vUv.x;
            float vy = vUv.y;
            float r = sr - (sr - tr) * vy;
            float g = sg - (sg - tg) * vy;
            float b = sb - (sb - tb) * vy;
            float a = pow((1.0 - vy), 2.0);
            //float a = 1.0;
            gl_FragColor = vec4(r, g, b, a);
            //gl_FragColor = vec4(sr, sg, sb, 1.0);
        }
    </script>

    <script type="x-shader/x-fragment" id="glitchFragmentShader">
        varying vec2 vUv;
        uniform sampler2D tDiffuse;

        void main() {
            float vx = vUv.x;
            float vy = vUv.y;
            // if (vy < 0.5 && vy > 0.45) {
            //     vx = vx + sin(vy/0.025)/10.0;
            // }
            gl_FragColor = texture2D(tDiffuse, vec2(vx, vy));
        }
    </script>



    <script type="x-shader/x-fragment" id="postProcessingShader">
        uniform float time;
        uniform float nIntensity;
        uniform float sIntensity;
        uniform float sCount;
        uniform sampler2D tDiffuse;
        varying vec2 vUv;

        uniform float colorScheme;

        // vec2 mod289(vec2 x) {
        //     return x - floor(x * (1.0 / 289.0)) * 289.0;
        // }
        // vec3 permute(vec3 x) {
        //     return mod289(((x*34.0)+1.0)*x);
        // }

        // float snoise(vec2 v) {
        //     const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0
        //                       0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)
        //                      -0.577350269189626,  // -1.0 + 2.0 * C.x
        //                       0.024390243902439); // 1.0 / 41.0
        //     vec2 i = floor(v + dot(v, C.yy));
        //     vec2 x0 = v -   i + dot(i, C.xx);

        //     vec2 i1;
        //     i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
        //     vec4 x12 = x0.xyxy + C.xxzz;
        //     x12.xy -= i1;

        //     i = mod289(i); // Avoid truncation effects in permutation,
        //     vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))
        //        + i.x + vec3(0.0, i1.x, 1.0 ));

        //     vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
        //     m = m * m;
        //     m = m * m;

        //     vec3 x = 2.0 * fract(p * C.www) - 1.0;
        //     vec3 h = abs(x) - 0.5;
        //     vec3 ox = floor(x + 0.5);
        //     vec3 a0 = x - ox;

        //     m *= 1.79284291400159 - 0.85373472095314 * (a0 * a0 + h * h);

        //     vec3 g;
        //     g.x  = a0.x  * x0.x  + h.x  * x0.y;
        //     g.yz = a0.yz * x12.xz + h.yz * x12.yw;
        //     return 130.0 * dot(m, g);
        // }

        void main() {
            vec4 cTextureScreen = texture2D( tDiffuse, vUv );
            float x = vUv.x * vUv.y * time *  1000.0;
            x = mod( x, 13.0 ) * mod( x, 123.0 );
            float dx = mod( x, 0.01 );

            vec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx * 100.0, 0.0, 1.0 );

            vec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );
            cResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;

            cResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );


            vec3 gResult = vec3( 1.0 - (cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 ));
            gResult.r = gResult.r * gResult.r;
            gResult.g = gResult.g * gResult.g;
            gResult.b = gResult.b * gResult.b;
            gResult = mix(gResult, vec3(0.01, 0.01, 0.01), 0.7);

            cResult = mix(cResult, gResult, colorScheme);

            gl_FragColor =  vec4( cResult, cTextureScreen.a );
        }
    </script>

</body>
</html>